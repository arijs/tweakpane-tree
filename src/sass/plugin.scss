// Import core styles
@use '../../node_modules/@arijs/tweakpane-core/lib/sass/tp';

// Additional style for the tree plugin
.#{tp.$prefix}-treev {
	// Extend a general input view style
	@extend %tp-theming;

	background-color: tp.cssVar('input-bg');
	cursor: default;
	// Remove fixed min-height, let the tree determine the height
	height: auto;
	position: relative;
	border-radius: tp.cssVar('base-border-radius');

	&.#{tp.$prefix}-v-disabled {
		opacity: 0.5;
	}

	&_container {
		padding: 4px 0;
	}

	// Tree node (with children) - using <details>
	&_node {
		margin: 0;
		padding: 0;
	}

	// Summary element for tree nodes
	&_summary {
		// background-color: tp.cssVar('input-bg');
		color: tp.cssVar('input-fg');
		cursor: pointer;
		list-style: none;
		padding: 4px 8px;
		user-select: none;

		// Hover state: use a hovered background and invert text/background to
		// ensure good contrast in both light/dark themes.
		&:hover {
			background-color: tp.cssVar('input-bg-hover');
			color: tp.cssVar('input-fg');
		}

		// Hide default disclosure triangle
		&::-webkit-details-marker {
			display: none;
		}

		// Custom disclosure triangle
		&::before {
			content: 'â–¸';
			display: inline-block;
			margin-right: 4px;
			transition: transform 0.15s ease;
		}
	}

	// When details is open, rotate the triangle
	&_node[open] > &_summary::before {
		transform: rotate(90deg);
	}

	// Selectable summary (node with value)
	// Selectable summaries receive a distinct hover (stronger) state.
	// Use the data attribute that the view exposes to match summaries reliably.
	// & [data-tree-summary].#{tp.$prefix}-selectable,
	// & [data-tree-summary][data-tree-summary] {
	// 	&:hover {
	// 		background-color: tp.cssVar('button-bg-active');
	// 		color: tp.cssVar('input-bg');
	// 	}
	// }

	// Children container
	&_children {
		padding-left: 16px;
	}

	// Leaf option
	&_option {
		// background-color: tp.cssVar('input-bg');
		color: tp.cssVar('input-fg');
		cursor: pointer;
		padding: 4px 8px;
		user-select: none;

		&:hover {
			background-color: tp.cssVar('input-bg-hover');
			color: tp.cssVar('input-fg');
		}

		&:active {
			background-color: tp.cssVar('input-bg-active');
			color: tp.cssVar('input-fg');
		}
	}

	// Selected state: view marks the selected element with
	// `[data-tree-selected="true"]` (set in view.ts). Provide a clear
	// selected background and a contrasting text color.
	& [data-tree-selected='true'] {
		background-color: tp.cssVar('input-bg-active');
		color: tp.cssVar('input-fg');
		// border-left: 3px solid tp.cssVar('accent');
		// padding-left: 6px; // accommodate the left border
	}

	& [data-tree-selected='true']:hover {
		// Keep the selected background stable on hover to avoid contrast issues
		background-color: tp.cssVar('input-bg-active');
		color: tp.cssVar('input-fg');
	}
}
